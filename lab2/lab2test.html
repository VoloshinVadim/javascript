<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Mocha Tests for Lab 2</title>
  <!-- Mocha styles -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mocha/9.1.3/mocha.css">
</head>
<body>
  <!-- Element to hold the test results -->
  <div id="mocha"></div>

  <!-- Mocha and Chai libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mocha/9.1.3/mocha.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chai/4.3.4/chai.js"></script>

  <!-- Our functions to be tested -->
  <script src="lab2.js"></script>

  <script>
    // Set up Mocha to use the BDD interface
    mocha.setup('bdd');
    // Gain access to Chai's "assert"
    const assert = chai.assert;
  </script>

  <!-- Test script -->
  <script>
    describe('pow(x, n)', function() {
      it('возводит 2 в степень 2, результат 4', () => assert.equal(pow(2, 2), 4));
      it('возводит 2 в степень 0, результат 1', () => assert.equal(pow(2, 0), 1));
      it('возводит 2 в степень -2, результат 0.25', () => assert.equal(pow(2, -2), 0.25));
      it('возводит 3 в степень 3, результат 27', () => assert.equal(pow(3, 3), 27));
    });

    describe('sumTo(n)', function() {
      it('сумма до 100 равна 5050', () => assert.equal(sumTo(100), 5050));
      it('сумма до 1 равна 1', () => assert.equal(sumTo(1), 1));
      it('сумма до 4 равна 10', () => assert.equal(sumTo(4), 10));
    });

    describe('isLeapYear(year)', function() {
      it('2024 год - високосный', () => assert.isTrue(isLeapYear(2024)));
      it('2025 год - не високосный', () => assert.isFalse(isLeapYear(2025)));
      it('2000 год - високосный (кратен 400)', () => assert.isTrue(isLeapYear(2000)));
      it('1900 год - не високосный (кратен 100, но не 400)', () => assert.isFalse(isLeapYear(1900)));
    });

    describe('factorial(n)', function() {
      it('факториал 0 равен 1n', () => assert.strictEqual(factorial(0), 1n));
      it('факториал 5 равен 120n', () => assert.strictEqual(factorial(5), 120n));
      it('факториал 1 равен 1n', () => assert.strictEqual(factorial(1), 1n));
      it('факториал 20 равен 2432902008176640000n', () => assert.strictEqual(factorial(20), 2432902008176640000n));
    });

    describe('fib(n)', function() {
      it('0-е число Фибоначчи равно 0n', () => assert.strictEqual(fib(0), 0n));
      it('1-е число Фибоначчи равно 1n', () => assert.strictEqual(fib(1), 1n));
      it('2-е число Фибоначчи равно 1n', () => assert.strictEqual(fib(2), 1n));
      it('10-е число Фибоначчи равно 55n', () => assert.strictEqual(fib(10), 55n));
      it('100-е число Фибоначчи равно 354224848179261915075n', () => assert.strictEqual(fib(100), 354224848179261915075n));
    });
    
    describe('compare(x)', function() {
      const compareWith5 = compare(5);
      it('сравнивает с 5: 4 < 5, возвращает false', () => assert.isFalse(compareWith5(4)));
      it('сравнивает с 5: 5 = 5, возвращает null', () => assert.isNull(compareWith5(5)));
      it('сравнивает с 5: 6 > 5, возвращает true', () => assert.isTrue(compareWith5(6)));
    });
    
    describe('sum(...)', function() {
        it('сумма без аргументов равна 0', () => assert.equal(sum(), 0));
        it('сумма одного аргумента (1) равна 1', () => assert.equal(sum(1), 1));
        it('сумма двух аргументов (1, 2) равна 3', () => assert.equal(sum(1, 2), 3));
        it('сумма нескольких аргументов (1, 2, 3, 4) равна 10', () => assert.equal(sum(1, 2, 3, 4), 10));
    });

    describe('addBlackSpot(obj)', function() {
        it('добавляет символьное свойство к пустому объекту', () => {
            const myObject = {};
            addBlackSpot(myObject);
            const blackSpotSymbol = Symbol.for("blackSpot");
            assert.isTrue(myObject[blackSpotSymbol]);
        });
        it('возвращает тот же самый объект', () => {
            const myObject = { a: 1 };
            const resultObject = addBlackSpot(myObject);
            assert.strictEqual(myObject, resultObject);
        });
    });

  </script>
  <!-- Run the tests -->
  <script>
    mocha.run();
  </script>
</body>
</html>
